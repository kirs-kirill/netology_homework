# –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –∫ –∑–∞–Ω—è—Ç–∏—é ¬´–°–µ—Ç–µ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –≤ K8S. –ß–∞—Å—Ç—å 2¬ª

### –¶–µ–ª—å –∑–∞–¥–∞–Ω–∏—è

–í —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ Kubernetes –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥–≤—É–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º —Å–Ω–∞—Ä—É–∂–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ –ø–æ —Ä–∞–∑–Ω—ã–º –ø—É—Ç—è–º.

------

### –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ –¥–æ–º–∞—à–Ω–µ–º—É –∑–∞–¥–∞–Ω–∏—é

1. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ k8s-—Ä–µ—à–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, MicroK8S).
2. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ª–æ–∫–∞–ª—å–Ω—ã–π kubectl.
3. –†–µ–¥–∞–∫—Ç–æ—Ä YAML-—Ñ–∞–π–ª–æ–≤ —Å –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã–º Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º.

------

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≥–æ–¥—è—Ç—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è

1. [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è](https://microk8s.io/docs/getting-started) –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ MicroK8S.
2. [–û–ø–∏—Å–∞–Ω–∏–µ](https://kubernetes.io/docs/concepts/services-networking/service/) Service.
3. [–û–ø–∏—Å–∞–Ω–∏–µ](https://kubernetes.io/docs/concepts/services-networking/ingress/) Ingress.
4. [–û–ø–∏—Å–∞–Ω–∏–µ](https://github.com/wbitt/Network-MultiTool) Multitool.

------

### –ó–∞–¥–∞–Ω–∏–µ 1. –°–æ–∑–¥–∞—Ç—å Deployment –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π backend –∏ frontend

1. –°–æ–∑–¥–∞—Ç—å Deployment –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è _frontend_ –∏–∑ –æ–±—Ä–∞–∑–∞ nginx —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ä–µ–ø–ª–∏–∫ 3 —à—Ç.
2. –°–æ–∑–¥–∞—Ç—å Deployment –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è _backend_ –∏–∑ –æ–±—Ä–∞–∑–∞ multitool. 
3. –î–æ–±–∞–≤–∏—Ç—å Service, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–µ—Å–ø–µ—á–∞—Ç –¥–æ—Å—Ç—É–ø –∫ –æ–±–æ–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞. 
4. –ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–∏–¥—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ —Å –ø–æ–º–æ—â—å—é Service.
5. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã Deployment –∏ Service –≤ —Ä–µ—à–µ–Ω–∏–∏, –∞ —Ç–∞–∫–∂–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –∏–ª–∏ –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã –ø.4.


#### –†–µ—à–µ–Ω–∏–µ. 

1. [`back.yaml`](./back.yaml)
2. [`front.yaml`](./front.yaml)
3. [`front-service.yaml`](./front-service.yaml), [`back-service.yaml`](./back-service.yaml)
4. 
    ``` sh
    usem@mbp ~ % kubectl exec backend-9b4d8c545-xtdzd -ti -- bash
    backend-9b4d8c545-xtdzd:/# nslookup frontend-service
    Server:		10.96.0.10
    Address:	10.96.0.10#53

    Name:	frontend-service.default.svc.cluster.local
    Address: 10.107.191.153

    backend-9b4d8c545-xtdzd:/# curl frontend-service.default.svc.cluster.local:9001
    <!DOCTYPE html>
    <html>
    <head>
    <title>Welcome to nginx!</title>
    <style>
    html { color-scheme: light dark; }
    body { width: 35em; margin: 0 auto;
    font-family: Tahoma, Verdana, Arial, sans-serif; }
    </style>
    </head>
    <body>
    <h1>Welcome to nginx!</h1>
    <p>If you see this page, the nginx web server is successfully installed and working. Further configuration is required.</p>

    <p>For online documentation and support please refer to
    <a href="http://nginx.org/">nginx.org</a>.<br/>
    Commercial support is available at
    <a href="http://nginx.com/">nginx.com</a>.</p>

    <p><em>Thank you for using nginx.</em></p>
    </body>
    </html>
    ```
5.  
    ``` sh
    usem@mbp 1.5 % kubectl get pods
    NAME                        READY   STATUS    RESTARTS   AGE
    backend-9b4d8c545-xtdzd     1/1     Running   0          20m
    frontend-558cdbfb74-92kcg   1/1     Running   0          20m
    frontend-558cdbfb74-9mkbk   1/1     Running   0          20m
    frontend-558cdbfb74-qffjq   1/1     Running   0          20m
    usem@mbp 1.5 % kubectl get services
    NAME               TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)    AGE
    backend-service    ClusterIP   10.97.214.47     <none>        9002/TCP   111s
    frontend-service   ClusterIP   10.107.191.153   <none>        9001/TCP   111s
    kubernetes         ClusterIP   10.96.0.1        <none>        443/TCP    3d23h
    ```

------

### –ó–∞–¥–∞–Ω–∏–µ 2. –°–æ–∑–¥–∞—Ç—å Ingress –∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º —Å–Ω–∞—Ä—É–∂–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞

1. –í–∫–ª—é—á–∏—Ç—å Ingress-controller –≤ MicroK8S.
2. –°–æ–∑–¥–∞—Ç—å Ingress, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π –¥–æ—Å—Ç—É–ø —Å–Ω–∞—Ä—É–∂–∏ –ø–æ IP-–∞–¥—Ä–µ—Å—É –∫–ª–∞—Å—Ç–µ—Ä–∞ MicroK8S —Ç–∞–∫, —á—Ç–æ–±—ã –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Ç–æ–ª—å–∫–æ –ø–æ –∞–¥—Ä–µ—Å—É –æ—Ç–∫—Ä—ã–≤–∞–ª—Å—è _frontend_ –∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ /api - _backend_.
3. –ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø —Å –ø–æ–º–æ—â—å—é –±—Ä–∞—É–∑–µ—Ä–∞ –∏–ª–∏ `curl` —Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞.
4. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –∏–ª–∏ –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥—ã –ø.2.

#### –†–µ—à–µ–Ω–∏–µ

1. ``` sh
    usem@mbp ~ % minikube addons enable ingress
    üí°  ingress is an addon maintained by Kubernetes. For any concerns contact minikube on GitHub.
    You can view the list of minikube maintainers at: https://github.com/kubernetes/minikube/blob/master/OWNERS
    üí°  After the addon is enabled, please run "minikube tunnel" and your ingress resources would be available at "127.0.0.1"
        ‚ñ™ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—Ä–∞–∑ registry.k8s.io/ingress-nginx/kube-webhook-certgen:v1.4.4
        ‚ñ™ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—Ä–∞–∑ registry.k8s.io/ingress-nginx/controller:v1.11.3
        ‚ñ™ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—Ä–∞–∑ registry.k8s.io/ingress-nginx/kube-webhook-certgen:v1.4.4
    üîé  Verifying ingress addon...
    üåü  The 'ingress' addon is enabled
    ```
2. 
------